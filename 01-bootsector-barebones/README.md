*你可能需要先了解一下的概念：assenmbler、BIOS*

**目标：创建一个可以被BIOS当做启动磁盘的文件**

我们要做一个我们自己的启动扇区！

理论
------

当计算机启动时，BIOS不知道如何加载OS，所以对于引导扇区的位置必须提前有一个共识，你可以理解为这是一个magic number。 因此，引导扇区必须放置在已知的标准位置。 该位置是磁盘的第一个扇区(柱面0，磁头0，扇区0)，它需要512字节。

为了验证这个盘是不是可以被当做启动盘，BIOS会去检验一下第511和第512个字节是不是规定的magic number：`0xAA55`

这是一个最简单的启动扇区示例：
```
e9 fd ff 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
[               还有29行全是0的数据             ]
00 00 00 00 00 00 00 00 00 00 00 00 00 00 55 aa
```

这个程序基本上全是0，最后以`0xAA55`结尾，可以注意到在程序中最后2个字节是这样的```55 aa```，这是因为大小端的原因，而x86是小端，最开始的三个字节是无限循环的字节码。

有史以来最简单的启动扇区代码
-------------------------

你可以使用以下这段汇编来生成上面的二进制文件，当然也可以直接使用二进制编辑器进行编辑，这里推荐一个二进制编辑器```bless```，在Ubuntu上可以直接使用apt安装。

```nasm
; Infinite loop (e9 fd ff)
loop:
    jmp loop 

; Fill with 510 zeros minus the size of the previous code
times 510-($-$$) db 0
; Magic number
dw 0xaa55 
```

汇编解释：
1. ```dw 0xaa55```代表以2字节填充
2. ```times 510-($-$$) db 0```代表以1字节填充510-($-$$)次，其中db 0代表填充0x00这一个字节， times代表重复多少次；$代表当前字节位置，$$代表开始位置，所以$-$$代表前面已经具有的字节数，因为一共512字节，最后2字节需要以magic number来填充，所以510-($-$$)就是需要填充的字节数。

编译:
`nasm -f bin boot_sect_simple.asm -o boot_sect_simple.bin`

运行：

`qemu boot_sect_simple.bin`

你将会看到qemu启动了，然后窗口上打印了"Booting from Hard Disk..."，除此之外再无其他，这说明我们的程序正确了！